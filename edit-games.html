<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JUWA 試合速報システム - 試合登録</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="setup-screen" class="overlay">
        <div class="container">
        <div class="card">
        <div class="viewer-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
            <button type="button" class="btn-sm" onclick="location.href='index.html'">メニューに戻る</button>
            <button type="button" class="btn-sm" onclick="location.href='manual/manual_edit'">操作マニュアル</button>
        </div>
            <h2>試合設定 & 同期</h2>
            <div class="input-group">
                <label>参加する大会を選択<br>（大会を選択すると追加の設定画面が表示されます。）</label>
                <select id="select-league" onchange="handleLeagueSelect()">
                    <option value="">リーグを読み込み中...</option>
                </select>
            </div>

            <div id="mode-selection" class="hidden" style="margin-top: 20px;">
                <label>操作モードを選択</label>
                <div style="display: flex; gap: 10px; margin-top: 10px;">
                    <button type="button" class="btn-sm" onclick="showNewGameForm()" style="flex:1; background:#2ecc71; color:white;">新規試合を作成</button>
                    <button type="button" class="btn-sm" onclick="showExistingGameForm()" style="flex:1; background:#3498db; color:white;">既存試合を編集</button>
                </div>
            </div>

            <div id="new-game-form" class="hidden" style="margin-top: 20px; border-top: 1px solid #555; padding-top: 15px;">
                <div class="input-group">
                    <label>試合ID</label>
                    <div style="display: flex; gap: 5px;">
                        <input type="text" id="input-game-id" readonly placeholder="自動発行してください" style="width: 60%;">
                        <button type="button" id="gen-id-btn" class="btn-sm">自動発行</button>
                    </div>
                </div>
                <div class="input-group">
                    <label>先攻チーム</label>
                    <div style="display: flex; gap: 5px;">
                    <select id="top-team-name" style="width: 60%;">
                        <option value="loading">チーム情報を読み込み中...</option>
                    </select>
                    <button type="button" id="edit-top-member" onclick="setMemberData(false)">メンバー編集</button>
                    </div>
                </div>
                <div class="input-group">
                    <label>後攻チーム</label>
                    <div style="display: flex; gap: 5px;">
                    <select id="bottom-team-name" style="width: 60%;">
                        <option value="loading">チーム情報を読み込み中...</option>
                    </select>
                    <button type="button" id="edit-bottom-member" onclick="setMemberData(true)">メンバー編集</button>
                    </div>
                </div>
                <div class="input-group">
                <label>イニング数</label>
                <input type="number" id="input-innings" value="3" min="1" max="12" style="width: 30%;">
                </div>
                <button type="button" id="start-btn" class="btn-save">この内容で試合開始</button>
            </div>

            <div id="existing-game-form" class="hidden" style="margin-top: 20px; border-top: 1px solid #555; padding-top: 15px;">
                <div class="input-group">
                    <label>編集する試合を選択</label>
                    <select id="select-existing-game">
                        <option value="">試合を読み込み中...</option>
                    </select>
                </div>
                <button type="button" onclick="resumeGame()" class="btn-save" style="background:#3498db;">編集を再開する</button>
            </div>

            <div id="member-data-form" class="hidden" style="margin-top: 20px; border-top: 1px solid #555; padding-top: 15px;">
                <div class="input-group">
                    <h3 id="setting-team-name">チーム名</h3>
                    <input type="hidden" value="" id="isBottom">
                    <label>投手</label>
                    <div style="display: flex; gap: 5px;">
                    <select id="pitcher-name" style="width: 60%;">
                        <option value="loading">チーム情報を読み込み中...</option>
                    </select>
                    </div>
                </div>
                <div class="input-group">
                    <label>打順</label>
                    <table id="batting-order">
                    <tr>
                        <th style="width: 25%;">打順</th>
                        <th style="width: 50%;">メンバー</th>
                        <th style="width: 25%;">背番号</th>
                    </tr>
                    </table>
                </div>
                <button type="button" id="submit-member" onclick="submitMemberData()" class="btn-save">この内容で確定</button>
            </div>
        </div>
        </div>
    </div>

    <div id="main-app" class="container hidden">
      <div class="viewer-header" style="display: flex; justify-content: space-between; align-items: center;">
            <button type="button" class="btn-sm" onclick="location.href='index.html'">メニューに戻る</button>
        </div>
        <br>
        <div class="header-status">
            <div id="display-game-id">ID: ----</div>
            <div id="sync-status">同期オフライン</div>
        </div>

        <section class="score-board">
        <table id="scoreboard">
            <thead id="scoreboard-head">
            <tr id="header-row">
                <th>チーム</th>
                <th>R</th>
            </tr>
            </thead>
            <tbody id="scoreboard-body">
            <tr id="score-row-top">
                <td id="top-team-name-cell" class="team-name-cell">先攻</td>
                <td class="total-cell" id="total-score-top">0</td>
            </tr>
            <tr id="score-row-bottom">
                <td id="bottom-team-name-cell" class="team-name-cell">後攻</td>
                <td class="total-cell" id="total-score-bottom">0</td>
            </tr>
            </tbody>
        </table>
        </section>
        <section class="pitch-counter-box">
            <div class="match-status-bar">
                <div class="status-item current-pitcher">
                    <span class="label">ピッチャー</span>
                    <span id="display-pitcher-name" class="value">読み込み中...</span>
                </div>

                <div class="status-item pitch-count">
                    <span class="label">PITCHES</span>
                    <span id="display-pitch-count" class="value">0</span>
                </div>

                <div class="status-item current-batter">
                    <span class="label">バッター</span>
                    <span id="display-batter-name" class="value">読み込み中...</span>
                </div>
            </div>
        </section>
        <div class="status-container">
            <section class="counts">
                <div class="count-row">
                    <span class="label">B</span>
                    <div class="dots">
                        <span class="dot ball"></span><span class="dot ball"></span><span class="dot ball"></span>
                    </div>
                </div>
                <div class="count-row">
                    <span class="label">S</span>
                    <div class="dots">
                        <span class="dot strike"></span><span class="dot strike"></span>
                    </div>
                </div>
                <div class="count-row">
                    <span class="label">O</span>
                    <div class="dots">
                        <span class="dot out"></span><span class="dot out"></span>
                    </div>
                </div>    
            </section>

            <section class="diamond">
                <div class="base" id="base2"></div>
                <div class="base" id="base3"></div>
                <div class="base" id="base1"></div>
            </section>
        </div>

        <section class="controls">
<div class="button-group">
    <button type="button" id="strike-btn" class="btn strike">ストライク</button>
    <button type="button" id="ball-btn" class="btn ball">ボール</button>
    <button type="button" id="foul-btn" class="btn strike">ファウル</button>
    <button type="button" id="out-btn" class="btn out">アウト</button>
</div>
<div class="button-group">
    <button type="button" id="single-hit-btn" class="btn hit">シングルヒット</button>
    <button type="button" id="double-hit-btn" class="btn hit">ダブルヒット</button>
    <button type="button" id="triple-hit-btn" class="btn hit">トリプルヒット</button>
    <button type="button" id="hr-btn" class="btn hr">ホームラン</button>
</div>
            <div class="button-group full-width">
                <button type="button" id="undo-btn" class="btn undo">1つ戻る（修正） </button>
            </div>
            <div class="button-group full-width">
                <button type="button" id="change-pitcher-btn" class="btn change-player">投手交代</button>
            </div>
          <div class="button-group full-width" style="margin-top: 10px;">
    <button type="button" id="end-game-btn" class="btn" style="background: #c0392b; border-bottom: 4px solid #a93226;">試合を終了する</button>
</div>
        </section>
    </div>

    <script src="js/common.js"></script>
    <script src="js/edit-games.js"></script>
</body>
</html>